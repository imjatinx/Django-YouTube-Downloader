<!-- <!DOCTYPE html>
<html>

<head>
    <title>YouTube Video Downloader</title>
</head>

<body>
    <h1>YouTube Video Downloader</h1>
    <input type="text" id="videoUrl" placeholder="Enter YouTube Video URL">
    <button id="downloadButton">Download Video</button>

    <div id="downloadLinks" style="display: none;">
        <p>Download Links:</p>
        <a id="downloadLink" href="#" download>Download Video</a>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const videoUrlInput = document.getElementById('videoUrl');
            const downloadButton = document.getElementById('downloadButton');
            const downloadLinksDiv = document.getElementById('downloadLinks');
            const downloadLink = document.getElementById('downloadLink');

            downloadButton.addEventListener('click', function () {
                const videoUrl = videoUrlInput.value;
                if (videoUrl) {
                    downloadYouTubeVideo(videoUrl);
                }
            });

            function downloadYouTubeVideo(videoUrl) {
                fetch(`/download?videoUrl=${videoUrl}`)
                    .then(response => {
                        return response.json()
                    })
                    .then(data => {
                        if (data.downloadLink) {
                            downloadLinksDiv.style.display = 'block';
                            downloadLink.href = data.downloadLink;
                            // downloadLink.download = 'video.mp4'
                            // downloadLink.click();
                        } else {
                            alert('Error downloading the video.');
                        }
                    });
            }
        });

    </script>
</body>

</html> -->

<!DOCTYPE html>
<html>
<head>
    <title>YouTube Video Downloader</title>
</head>
<body>
    <h1>YouTube Video Downloader</h1>

    <form id="downloadForm">
        <input type="text" id="videoUrl" placeholder="Enter YouTube Video URL">
        <button type="submit" id="downloadButton">Download Video</button>
    </form>
    
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const downloadForm = document.getElementById('downloadForm');
            const videoUrlInput = document.getElementById('videoUrl');

            downloadForm.addEventListener('submit', function (e) {
                e.preventDefault(); // Prevent the form from actually submitting

                const videoUrl = videoUrlInput.value;
                if (videoUrl) {
                    downloadYouTubeVideo(videoUrl);
                }
            });

            function downloadYouTubeVideo(videoUrl) {
                // Send an AJAX request to the server to download the video
                fetch(`/download?videoUrl=${videoUrl}`)
                    .then(response => {
                        if (response.ok) {
                            const contentDisposition = response.headers.get('content-disposition');
                            const match = /filename="(.+?)"/.exec(contentDisposition);
                            const filename = match ? match[1] : 'video.mp4';
                            // Trigger the download by creating a link element and clicking it
                            response.blob().then(blob => {
                                const url = window.URL.createObjectURL(blob);
                                const a = document.createElement('a');
                                a.href = url;
                                a.download = filename; // Set the desired file name
                                a.style.display = 'none';
                                document.body.appendChild(a);
                                a.click();
                                window.URL.revokeObjectURL(url);
                            });
                        } else {
                            alert('Error downloading the video.');
                        }
                    });
            }
        });
    </script>
</body>
</html>
